<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>登录界面</title>
    <link rel="stylesheet" type="text/css" href="css/login.css">
</head>
<body>
<div class="wrap">
    <!--头部开始-->
    <div class="head">
        <div class="line"></div>
        <div class="head_mid">

            <div class="logo">
                <img src="images/logo.png" alt="" style="margin-left:20px;">
            </div>
        </div>
    </div>
    <!--头部结束-->

    <!--主体部分开始-->
    <div class="main">
        <div class="main_mid">
            <div class="mainLeft"></div>
            <div class="mainRight">
                <ul class="tab">
                    <li class="person active">个人登录</li>
                    <li class="company">公司卡号登录</li>
                </ul>
                <div class="content">
                    <div class="perContent selected">
                        <form action="" name="form" class="form">
                            <input type="radio" checked="checked" name="log"/><span>普通登录</span>
                            <input type="radio" name="log"/><span>手机动态密码登录</span>
                        </form>
                        <div class="tishi">请输入对应的信息</div>
                        <div class="texts username">
                            <a href="javascript:;" class="bg_uname a1"></a>
                            <span class="unameText" >用户名</span>
                            <input type="text" placeholder="会员手机号码/邮箱" id="vipName_email"/>
                            <div class="alert2"></div>
                        </div>
                        <div class="texts pwd">
                            <a href="javascript:;" class="bg_uname a2"></a>
                            <span class="unameText" >密 码</span>
                            <input type="text" placeholder="请输入密码" id="pwd"/>
                            <div class="alert2"></div>
                        </div>
                        <div class="texts yzm">
                            <a href="javascript:;" class="bg_uname a3"></a>
                            <span class="unameText" >验证码</span>
                            <input type="text" placeholder="请输入验证码" class="yzmInput"/>
                            <!--<div class="alert2 alert3" style="border: 1px solid #000;"></div>-->
                        </div>
                        <div class="ma" id="yzm">1236</div>
                        <input type="button" value="登录" class="btnLogin" id="btnLogin1"/>
                        <p>
                            <span>享更多特权,</span>
                            <a href="reg.html" class="reg_login">立即注册</a>
                            <a href="reg.html" class="arrow"></a>
                            <a href="javascript:;" class="regit">忘记密码？</a>
                        </p>
                        <div class="join">
                            <p class="joinP">使用合作网站账号登录</p>
                            <div class="bot_links">
                                <a href="javascript:;" class="links_a ">
                                    <i class="icon qq"></i>
                                    QQ登录
                                </a>
                                <a href="javascript:;" class="links_a ">
                                    <i class="icon weibo"></i>
                                    微博登录
                                </a>
                                <a href="javascript:;" class="links_a zfbPays">
                                    <i class="icon zfbPay"></i>
                                    支付宝登录
                                </a>
                                <a href="javascript:;" class="links_a ">
                                    <i class="icon weixin"></i>
                                    微信登录
                                </a>

                            </div>

                        </div>

                    </div>
                    <div class="perContent comContent">
                        <!--<form action="" name="form" class="form">-->
                            <!--<input type="radio" checked="checked" name="log"/><span>普通登录</span>-->
                            <!--<input type="radio" name="log"/><span>手机动态密码登录</span>-->
                        <!--</form>-->
                        <div class="texts username " id="uname">
                            <a href="javascript:;" class="bg_uname a1"></a>
                            <span class="unameText" >用户名</span>
                            <input type="text" placeholder="会员手机号码/邮箱"/>
                        </div>
                        <div class="texts pwd">
                            <a href="javascript:;" class="bg_uname a2"></a>
                            <span class="unameText" >密 码</span>
                            <input type="text" placeholder="请输入密码"/>
                        </div>
                        <div class="texts yzm">
                            <a href="javascript:;" class="bg_uname a3"></a>
                            <span class="unameText" >验证码</span>
                            <input type="text" placeholder="请输入验证码" class="yzmInput"/>
                        </div>
                        <div class="ma">1236</div>
                        <input type="button" value="登录" class="btnLogin" id="btnLogin"/>
                        <p>
                            <span>享更多特权,</span>
                            <a href="reg.html" class="reg_login">立即注册</a>
                            <a href="reg.html" class="arrow"></a>
                            <a href="javascript:;" class="regit">忘记密码？</a>
                        </p>
                        <div class="join">
                            <p class="joinP">使用合作网站账号登录</p>
                            <div class="bot_links">
                                <a href="javascript:;" class="links_a ">
                                    <i class="icon qq"></i>
                                    QQ登录
                                </a>
                                <a href="javascript:;" class="links_a ">
                                    <i class="icon weibo"></i>
                                    微博登录
                                </a>
                                <a href="javascript:;" class="links_a zfbPays">
                                    <i class="icon zfbPay"></i>
                                    支付宝登录
                                </a>
                                <a href="javascript:;" class="links_a ">
                                    <i class="icon weixin"></i>
                                    微信登录
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--主体部分结束-->

    <!--尾部开始-->
    <div class="copyRight">
        <div class="copyRight_mid">
            <div class="links">
                <a href="javascript:;">关于好客汇</a>
                <a href="javascript:;">酒店加盟</a>
                <a href="javascript:;">职业招聘</a>
                <a href="javascript:;">意见反馈</a>
                <a href="javascript:;">联系我们</a>
            </div>
            <p class="copy">沪ICP备12041475 | © 2016 Huazhu All Rights reserved.华住酒店管理有限公司</p>
        </div>
    </div>
    <!--尾部结束-->

</div>
</body>
</html>
<script src="js/jquery-1.12.3.min.js"></script>
<script src="js/jquery-3.0.0.js"></script>

<!--登录校验-->
<script>
    $(function(){
        //一进入登录页面就随机产生随机验证码 自动刷新一回
        $("#yzm").html(getYzm());

    //业务逻辑
        //当点击个人登录时显示个人登录的内容  否则显示公司登录的内容
       $(".tab>li").on("click",function(){
           $(this).addClass("active").siblings("li").removeClass("active");
           var $index = $(this).index();
           $(".content>div").eq($index).addClass("selected").siblings("div").removeClass("selected");
       })

        //封装一个函数产生随机的验证码
        function getYzm(){
            var str= "";
            for(var i=0;i<4;i++){
                str += parseInt(Math.random()*10);
            }
            return str;
        }
        $("#yzm").on("click", function(){
            $(this).html(getYzm());
        })

        //验证用户名  手机号码作为用户名
        $("#vipName_email").on("blur",function(){
            var tel = $(this).val();
            var pattern=/^1\d{10}$/;
            var isTrue = pattern.test(tel);
            if(isTrue){
                $(".tishi").html("用户名合法").css("color","blue");
            }else{
                $(".tishi").html("用户名不合法").css("color","red");
            }
        });

        //验证密码
        $("#pwd").on("blur", function(){
            var pwd = $(this).val().replace(/ /g,"");
            var pattern = /^.{6,16}$/;
            var isTrue = pattern.test(pwd);
            if(isTrue){
                $(".tishi").html("密码合法").css("color","blue");
            }else{
                $(".tishi").html("密码不合法").css("color","red");
            }
        })

        //核对验证码
        $(".yzmInput").on("blur", function(){
           if($("#yzm").text() == $(this).val()) {
               $(".tishi").html("验证码正确").css("color","blue");
//               alert("验证码正确");
           }else{
               $(".tishi").html("验证码不正确").css("color","blue");

//               alert("验证码不正确");
           }
        })

        //给登录按钮注册点击事件
        $("#btnLogin1").on("click",function(){
            var tel = $("#vipName_email").val();
            var pattern1=/^1\d{10}$/;
            var isTrue1 = pattern1.test(tel);

            var pwd = $("#pwd").val().replace(/ /g,"");
            var pattern2 = /^.{6,16}$/;
            var isTrue2 = pattern2.test(pwd);

            //isTrue1 && isTrue2 && ($("#yzm").text() == $(".yzmInput").val())
            if(isTrue1 && isTrue2 && ($("#yzm").text() == $(".yzmInput").val())){
                var $tel = $("#vipName_email").val();
            console.log($tel);
            var $pwd = $("#pwd").val();
            console.log($pwd);

            $.ajax({
                    url:"login.json",
                    type:"get",
                    dataType:"json",
                    success:function(data){
//                        alert(1);
                        console.log(data);
                        var flag = true;
                        $.each(data,function(index,val){
                            console.log(val.tel);
                            if($tel == val.tel && $pwd == val.pwd){
                                //如果是用户名和密码匹配成功就进行页面跳转
                                window.location.href="index.html";
                                flag = false;
                            }
                            if(flag){
                                $(".tishi").html("用户名或密码错误,请核对！").css("color","red");
                                $("#yzm").html(getYzm());
                            }
                        })
                    },
                   error: function(error){
                      alert("出错了。。。");
                       $("#yzm").html(getYzm());
                   }
                })

//                var num=3;
//                setInterval(function(){
//                     num--;
//                    if(num == 0){
//                        window.location.href="index.html";
//                    }
//                })
            }else{
                alert("哎呀，出错了。。。");
                $("#yzm").html(getYzm());
            }

        })


    })
</script>